{
  "hash": "422e6a91c74cf247d4e601d072c6bfdf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Markov Models in Economic Evaluations IV\"\ndescription: \"\"\nauthor:\n  - name: Andrea Gabrio\n    url: https://angabrio.github.io/agabriosite2/\n    orcid: 0000-0002-7650-4534\n    affiliation: Maastricht University\n    affiliation-url: https://www.maastrichtuniversity.nl/research/methodology-and-statistics\ndate: 2025-03-11\ncategories: [Quarto, R, Academia, Health Economics] # self-defined categories\n#citation: \n#  url: https://samanthacsik.github.io/posts/2022-10-24-my-blog-post/ \nimage: featured.png\nbibliography: references.bib\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n---\n\n\n\n![](featured.png){fig-align=\"center\"}\n\nHello dear readers and welcome to a new post. Today, I would like to resume my current series of posts related to decision analytic models in health economics and focus on some extensions of the simple Markov model structure which I introduced in a [post](../2024-11-10-my-blog-post/index.qmd) a few months ago. I suggest to check out my previous post for a summary introduction and description of what Markov models are and for what they are used. \n\nA simplifying assumption of traditional Markov models is that the *transition probabilities* regulating the movement between health states remain constant across the model cycles, i.e. over time. In some cases, this simplification of the reality may represent a too strong assumption that, if kept, may lead to misleading cost-effectiveness results. When this occurs, there are different approaches that can be used to overcome this problem and allow at least some transition probabilities to vary over time. Before going into the technical details on how to do this, I would like first to provide a quick description of the different types of time-dependency that can be allowed for transition probabilities and when a specific type might be preferable to use compared to another. For the topics discussed in this post, I took inspiration from @caldwell2007decision, which I strongly suggest to consult if you would like to have a more in-depth look into the matter.\n\n## Type of time-dependency\n\nThe first type of time-dependency allows transition probabilities to *vary according to the time in the model*, so that the probability of a transition between states changes as the cohort ages. For example, when modelling the evolution of a deadly disease, it may be more reasonable to assume that the probability of moving to a death state increases as the cohort ages. To ensure this is possible, the starting age of a cohort should be stated, so that the age of the cohort at any cycle of the model is also known. We can then implement age-dependent transition probabilities by having a unique probability for each cycle. Commonly, these cycle-dependent transition probabilities are taken from the literature under the form of national life-tables, where death probabilities for different age groups for the target population are usually reported. In general, it makes sense for the transition probabilities to increase as the cohort ages. In addition, since all transition probabilities in a given cycle need to sum up to 1, the probability of remaining in a given state for the next cycle has also to allow for an age-dependent probability.\n\nThe second type of time-dependency allows transition probabilities to *vary according to time in state*, so that the probability changes as the time spent in a state increases. For example, when modelling the evolution of a deadly disease, it may be more reasonable to assume that the probability to move to a death state from a specific disease state increases as the time spent by patients in that disease state also increases. This can be modelled by assuming that the probability of moving between a given state A to another in the model varies according on how long the patient had been in the given state A, given that all patients start in the model in state A at a given time and that once they leave it they cannot return in it. This allows to keep track of how long a patient has been in state A and makes the transition probability dependent on time in a state equivalent to making it dependent on the age of the cohort.\n\nWhen external sources providing information on age-dependent transition probabilities are not available, the relationship between a transition probability and time can be estimated using patient-level data, i.e. in the form of a longitudinal study recording the time to an event for each patient. Estimation can then be performed by means of *survival analysis* methods, which allow to handle (noninformative) censoring which frequently occurs in longitudinal studies, i.e. when observations stop being recorded before a patient has had the chance of experiencing the event of interest. Usually, *parametric survival models*  are employed in order to obtain an estimate of the relation between the risk of experiencing an event and time, represented by the functional form of the hazard function. In particular, of key importance is the **survivor function**\n\n$$\nS(t)=P(T>t)=1-F(t),\n$$\n\ndenoting the probability of surviving (i.e. not experiencing the event) for a period of time greater than $t$, with $F(t)=P(T\\leq t)$ being the **cumulative density function**. We can also express the survivor function in terms of the **cumulative hazard function** such that\n\n$$\nS(t)=\\text{exp}\\{-H(t)\\},\n$$\n\nwhere, $H(t) $denotes the cumulative instantaneous chance of experiencing the event (i.e. hazard rate) at time $t$, conditional on having survived to time $t$. Using this relationship, it is possible to derive transition probabilities for Markov models. For example, let's consider a single type of Markov model with only two states, i.e. alive and death, so that only one transition probability needs to be estimated. Define the length of the Markov cycle as $u$ and let the instantaneous hazard of death at time $t$ be $h(t)$. We now need to estimate the discrete transition probability between the moments $(t-u)$ and $t$, say $p(t_u)$, where $t_u$ indicates that $t$ is now measured as integer multiples of the cycle length of the model $u$. \n\nThe baseline transition probability of the event of interest can be defined as\n\n$$\np(t_u)=1-\\frac{S(t)}{S(t-u)},\n$$\n\nwhich can be re-written in terms of the cumulative hazard as\n\n$$\np(t_u)=1-\\frac{\\text{exp}\\{-H(t)\\}}{\\text{exp}\\{-H(t-u)\\}}=1-\\text{exp}\\{H(t-u)-H(t)\\}\n$$\n\n## A simple example \n\nAs a demonstrative example, let's consider the transition matrix for the assumed transition probabilities for three health states (Well, Sick and Dead) for an hypothetical experimental treatment. Let's also assume that patients were randomised to one of two treatments, namely Experimental vs Control, and they were considered to be in either a Well or Sick state. Normally, if we kept the assumption of constant transition probabilities within the model, I would be able to compute what the transition matrix will look like after, say, $1$ month by simply multiplying the initial probabilities by the assumed $3\\times3$ transition matrix. In general, one can compute the proportion of patients for the $n+1$-th step in any of these three health states by simply multiplying the updated transition matrix at step $n$ by the given transition matrix. However, if we relax the assumption of constant transition probabilities over time, we need to create an entirely new transition matrix and specify how its entries changes over time. \n\nFor this example, I will focus on the second type of time-dependency under the assumption that time dependence is related to the time spent in a specific state, which requires expanding the state of interest with as many transient states as the number of cycles required to track the history of the cohort in that state. I will be mostly using references and take inspiration from a very nice example code in `R` provided by @alarid2023tutorial. Make sure to check it out if you want to have a more in-depth look at the code and related explanations. For example, if a transition rate decreases over the first three cycles spent in a state and then is constant from the fourth cycle onward, then four transient or \"tunnel\" states are needed for that state. The cohort resides in each tunnel state for one cycle, after which they either exit the tunnel or transition to the next tunnel state, with the total number of states being $n_{S\\text{tunnel}}=n_{S}+n_{\\text{tunnel}}-1$, where $n_{\\text{tunnel}$ is the total number of times a health state needs to be expanded to capture the relevant time dependence. The transition probability matrix also needs to be expanded to incorporate these additional transient states, resulting in a transition probability matrix of dimensions $n_{S\\text{tunnel}}\\times n_{S\\text{tunnel}}$. If transition probabilities are also dependent on simulation time, then we also need to expand it to a three-dimensional array with dimensions $n_{S\\text{tunnel}}\\times n_{S\\text{tunnel}}\\times n_{T}$.\n\nWe will assume that healthy individuals face an age-specific background mortality. Typically, all-cause mortality rates can be obtained from life tables in the form of age-specific mortality hazard rates $\\mu_a$, where $a$ refers to the specific age considered. Since this is just an example, let's simulate age-specific mortality rates which are assumed to be specified on a yearly basis for people aged $50-75$ years.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#define age intervals by years\nage <- rep(50:75)\n#set length of age vector\nage_n <- length(age)\n#generate age-specific mortality rates in the healthy population (Well)\nmu_a <- pexp(seq(from=0.5, to=3,by=0.1),rate = 0.01) \n\ndata_age <- data.frame(age,mu_a)\n\ndata_age\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   age        mu_a\n1   50 0.004987521\n2   51 0.005982036\n3   52 0.006975557\n4   53 0.007968085\n5   54 0.008959621\n6   55 0.009950166\n7   56 0.010939721\n8   57 0.011928287\n9   58 0.012915865\n10  59 0.013902456\n11  60 0.014888060\n12  61 0.015872680\n13  62 0.016856315\n14  63 0.017838968\n15  64 0.018820638\n16  65 0.019801327\n17  66 0.020781035\n18  67 0.021759765\n19  68 0.022737516\n20  69 0.023714290\n21  70 0.024690088\n22  71 0.025664910\n23  72 0.026638758\n24  73 0.027611633\n25  74 0.028583536\n26  75 0.029554466\n```\n\n\n:::\n:::\n\n\n\nTo compute the transition probability from state Well to state Sick, corresponding to the cohort’s age at each cycle, we transform the rate $\\mu_a$ to a transition probability assuming a constant exponential hazard rate within each year of age:\n\n$$\np_{[\\text{Well},\\text{Sick},t]}=1-\\text{exp}(-\\mu_{a_0+t}),\n$$\nwhere $a_{0}=50$ is the starting age of the cohort. We transform the vector of age-specific rates to a vector of probabilities by adjusting for the cycle length.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transform to age-specific background mortality risk for all cycles adjusting by cycle\np_a <- 1 - exp(-mu_a*age_n)\n```\n:::\n\n\n\nBecause mortality in the state Sick is relative to background mortality which depends on age, mortality in this state will also be age-dependent. To generate the age-specific mortality in this state, we multiply the age-specific background mortality rate $\\mu_a$ by the constant hazard ratio for Sick vs Well. We then convert the resulting age-specific mortality rate to probability.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Transition rates (annual), and hazard ratios (HRs) ----\nr_ws  <- 0.15  # constant annual rate of becoming Sick when Well\np_ws <-  1 - exp(- r_ws * age_n)  # constant annual probability of becoming Sick when Healthy conditional on surviving \nr_sw  <- 0.01   # constant annual rate of becoming Well when Sick\np_sw <-  1 - exp(- r_sw * age_n)  # constant annual probability of becoming Well when Sickly conditional on surviving \n# hazard ratio of death in Sick vs Well \nhr_sick  <- 3     \n## Age-specific mortality rate in the Sick state\nmu_a_sick <- mu_a * hr_sick # when Sick\n## Age-specific probability of dying in the Sick state\np_a_sick <- 1 - exp(-mu_a_sick)\n```\n:::\n\n\n\nTo incorporate simulation-time dependence into the transition probability matrix, we expand the dimensions of the matrix and create a $3$-dimensional transition probability array, $tm_a$ and use it in `R`, of dimensions $n_S \\times n_S \\times n_T$. The first two dimensions of this array correspond to transitions between states, where the rows determine departing states and columns destination states. The third dimension refers to the time since the simulation started. The $t$-th element in the third dimension corresponds to the transition probability matrix at cycle $t$.\n\nFirst, we initialize the transition probability array with a default value of zero for all transition probabilities.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#set simulation parameters\nn_t <- age_n\nn_s <- 3\nn_c <- 1000\nstate_names <- c(\"Well\",\"Sick\",\"Dead\")\n\n#initialise\ntm_a <- array(0, dim=c(n_s,n_s,n_t), dimnames = list(state_names, state_names, 0:(n_t - 1)))\n```\n:::\n\n\n\nThe code below illustrates how to assign age-dependent transition probabilities in the third dimension of the array. Most of this code is equivalent to populating the matrix `tm_a` for time-independent models. The only difference is the empty index added to the third dimension to represent the vector of transitions over time. For time-varying transitions, we provide a vector of transition probabilities. We only need to provide one value for the transition probability for constant transitions over time, and `R` replicates the value of such transitions as many times as the number of cycles ($n_T+1$ times in our example). To ensure that the sum of each row of each cycle-specific matrix equals one, we define the probability of staying in each state by subtracting the sum of the exiting probability vectors from one after conditioning on surviving each cycle. Finally, we initialize the transition probability array for an hypothetical control group as a copy of the matrix for the treatment but assuming a different (worse) hazard ratio for moving from Sick to the Dead state.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Fill in array\n## From Well\ntm_a[\"Well\", \"Well\", ] <- (1 - p_a) * (1 - p_ws)\ntm_a[\"Well\", \"Sick\", ] <- (1 - p_a) * p_ws\ntm_a[\"Well\", \"Dead\", ] <- p_a\n## From Sick\ntm_a[\"Sick\", \"Well\", ] <- (1 - p_a_sick) * p_sw\ntm_a[\"Sick\", \"Sick\", ] <- (1 - p_a_sick) * (1 - p_sw)\ntm_a[\"Sick\", \"Dead\", ] <- p_a_sick\n## From D\ntm_a[\"Dead\", \"Dead\", ] <- 1\n\n## Initialize transition probability matrix for control as a copy of the treatment TP matrix\ntm_a0 <- tm_a\n\n# hazard ratio of death in Sick vs Well under control\nhr_sick_0  <- 3.5     \n## Age-specific mortality rate in the Sick state under control\nmu_a_sick_0 <- mu_a * hr_sick_0 # when Sick\n## Age-specific probability of dying in the Sick state under control\np_a_sick_0 <- 1 - exp(-mu_a_sick_0)\n\n## Update only transition probabilities from Sick to Dead involving p_S\n## From Sick\ntm_a0[\"Sick\", \"Well\", ] <- (1 - p_a_sick_0) * p_sw\ntm_a0[\"Sick\", \"Sick\", ] <- (1 - p_a_sick_0) * (1 - p_sw)\ntm_a0[\"Sick\", \"Dead\", ] <- p_a_sick_0\n```\n:::\n\n\n\nNext, we initialise, set up and run the model under the assumption that everyone in the cohort starts in the Well state and progresses towards the Dead state according to age-specific and treatment-specific transition probability matrices. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Construct state-transition models ----\n## Initial state vector ----\n#* All starting healthy\nv_m_init <- c(Well = 1, Sick = 0, Dead = 0) # initial state vector\n\n## Initialize cohort traces ----\n### Initialize cohort trace under control ----\nm_M_0 <- matrix(NA, \n              nrow = (n_t + 1), ncol = n_s, \n              dimnames = list(0:n_t, state_names))\n#* Store the initial state vector in the first row of the cohort trace\nm_M_0[1, ] <- v_m_init\n\n### Initialize cohort trace for the new treatment ---\n#* Structure and initial states are the same as for control\nm_M_1  <- m_M_0 # trt 1\n\n## Create transition dynamics arrays ----\n#* These arrays will capture transitions from each state to another over time \n### Initialize transition dynamics array for control ----\narr_0 <- array(0,\n             dim = c(n_s, n_s, n_t + 1),\n             dimnames = list(state_names, state_names, 0:n_t))\n#* Set first slice of arr_0 with the initial state vector in its diagonal\ndiag(arr_0[, , 1]) <- v_m_init\n### Initialize transition-dynamics array for new treatment ----\n#* Structure and initial states are the same as for control\narr_1  <- arr_0\n\n\n#  Run Markov model ----\n#* Iterative solution of age-dependent TPs\nfor(t in 1:n_t){\n  ## Fill in cohort trace\n  # For 0\n  m_M_0[t + 1, ]  <- m_M_0[t, ]  %*% tm_a0[, , t]\n  # For 1\n  m_M_1[t + 1, ] <- m_M_1[t, ] %*% tm_a[, , t]\n  ## Fill in transition-dynamics array\n  # For 0\n  arr_0[, , t + 1]  <- diag(m_M_0[t, ]) %*% tm_a0[, , t]\n  # For 1\n  arr_1[, , t + 1] <- diag(m_M_1[t, ]) %*% tm_a[, , t]\n}\n\n\n#trt names\ntrt_names <- c(\"Control\",\"Treatment\")\n\n## Store the cohort traces in a list ----\nl_m_0 <- list(Control =  m_M_0,\n              Treatment   =  m_M_1)\nnames(l_m_0) <- trt_names\n\n## Store the transition dynamics array for each strategy in a list ----\nl_a_1 <- list(Control =  arr_0,\n              Treatment   =  arr_1)\nnames(l_a_1) <- trt_names\n\n\n## Store the transition dynamics array for each strategy in a list ----\nl_a_A <- list(Control =  arr_0,\n              Treatment   =  arr_1)\nnames(l_a_A) <- trt_names\n```\n:::\n\n\n\nThe state vector of the cohort’s distribution at cycle $t + 1$ is obtained by applying updating the transition probability matrix, obtained by the the matrix product between the row vector `m_M_0[t, ]` and the transition probability matrix `tm_a0[, , t]`. The vectors across all cycles are obtained by iteratively applying this update to each transition probability matrix of `tm_a0` across the third dimension using a for loop. @fig-1 and @fig-2 shows the cohort’s trace for all cycles of the age-dependent model under the control and treatment group, respectively.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Cohort trace under control.](index_files/figure-html/fig-1-1.png){#fig-1 fig-pos='h' width=70%}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Cohort trace under treatment.](index_files/figure-html/fig-2-1.png){#fig-2 fig-pos='h' width=70%}\n:::\n:::\n\n\n\nOnce the transition probabilities over the desired number of cycles are estimated/filled in, further data manipulation can be carried out to estimate the expected costs and effects, which can be included in an additional vector and then multiplied with the elements of the matrices after each cycle to generate the expected total costs and effects. We need to associate to each health state and treatment in the model a corresponding value for each of the outcomes that we want to measure, i.e. costs and utilities. Thus, we may assume that (yearly) utilities for each health state are $u^{well}=1$, $u^{sick}=0.75$, and $u^{dead}=0$ (across treatments). We may also assume that (yearly) costs vary between treatment groups and health states (Well, Sick, Dead), i.e. $c_{trt}=(2000,16000,0)$ and $c^{ctr}=(2000,4000,0)$. We also include utility and cost specific (yearly) values depending on whether the new treatment was received by the patient, such that: $u^{\\text{treated}}=0.95$, $c^{\\text{treated}}=12000$. Similarly, we introduce some penalties in terms of disutility or costs for those patients moving from Well to Sick or Dead state: $u^{\\text{WS}}=-0.01$, $c^{\\text{WS}}=1000$, $c^{\\text{D}}=2000$. Next, we need to determine the number of cycles of the model. In this case, we will use $26$ cycles  with each cycle being $1$ year long. Hence, the expected costs and QALYs for each month will be generated and then added up. Since the assessment covers a period longer than one year, we also apply discounting to utilities and costs using some pre-defined (annual) discount rates: $d^u=0.015$ and $d^c=0.035$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### State rewards ----\n#### Costs ----\nc_well    <- 2000  # annual cost of being Well\nc_sick   <- 4000  # annual cost of being Sick\nc_D    <- 0     # annual cost of being dead\nc_1 <- 12000 # annual cost of receiving treatment \n#### Utilities ----\nu_well    <- 1     # annual utility of being Healthy\nu_sick   <- 0.75  # annual utility of being Sick\nu_D    <- 0     # annual utility of being dead\nu_1 <- 0.95  # annual utility when receiving treatment \n\n### Transition rewards ----\ndu_ws <- 0.01  # disutility when transitioning from Well to Sick\nic_ws <- 1000  # increase in cost when transitioning from Well to Sick\nic_D   <- 2000  # increase in cost when dying\n\n### Discount weight for costs and effects ----\ncycle_length <- 1 #1 year\nd_c = 0.035 # annual discount rate for costs \nd_e = 0.015 # annual discount rate for QALYs,\nv_dwc  <- 1 / ((1 + (d_c * cycle_length)) ^ (0:n_t))\nv_dwe  <- 1 / ((1 + (d_e * cycle_length)) ^ (0:n_t))\n\n# State Rewards ----\n## Scale by the cycle length ----\n#* Vector of state utilities under control\nv_u_0    <- c(Well= u_well, \n                Sick = u_sick, \n                Dead  = u_D) * cycle_length\n#* Vector of state costs under control\nv_c_0    <- c(Well  = c_well, \n                Sick = c_sick,\n                Dead  = c_D) * cycle_length\n#* Vector of state utilities under trt\nv_u_1   <- c(Well  = u_well, \n                Sick = u_1, \n                Dead  = u_D) * cycle_length\n#* Vector of state costs under trt\nv_c_1   <- c(Well  = c_well, \n                Sick = c_sick + c_1,\n                Dead  = c_D) * cycle_length\n\n\n## Store state rewards ----\n#* Store the vectors of state utilities for each strategy in a list \nl_u <- list(Control = v_u_0,\n            Treatment   = v_u_1)\n#* Store the vectors of state cost for each strategy in a list \nl_c <- list(Control =  v_c_0,\n            Treatment   =  v_c_1)\n\n#* assign strategy names to matching items in the lists\nnames(l_u) <- names(l_c) <- trt_names\n\n# Compute expected outcomes ----\n#* Create empty vectors to store total utilities and costs \nv_tot_qaly <- v_tot_cost <- vector(mode = \"numeric\", length = 2)\nnames(v_tot_qaly) <- names(v_tot_cost) <- trt_names\n```\n:::\n\n\n\nWe are then ready to compute the expected outcomes based on the model results.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#define number of strategies \nn_str <- 2\n\n## Loop through each strategy and calculate total utilities and costs ----\nfor (i in 1:n_str) { # i <- 1\n  v_u_str <- l_u[[i]]   # select the vector of state utilities for the i-th strategy\n  v_c_str <- l_c[[i]]   # select the vector of state costs for the i-th strategy\n  a_A_str <- l_a_A[[i]] # select the transition array for the i-th strategy\n  \n  ##* Array of state rewards \n  #* Create transition matrices of state utilities and state costs for the i-th strategy \n  m_u_str   <- matrix(v_u_str, nrow = n_s, ncol = n_s, byrow = T)\n  m_c_str   <- matrix(v_c_str, nrow = n_s, ncol = n_s, byrow = T)\n  #* Expand the transition matrix of state utilities across cycles to form a transition array of state utilities\n  a_R_u_str <- array(m_u_str, \n                     dim      = c(n_s, n_s, n_t + 1),\n                     dimnames = list(state_names, state_names, 0:n_t))\n  # Expand the transition matrix of state costs across cycles to form a transition array of state costs\n  a_R_c_str <- array(m_c_str, \n                     dim      = c(n_s, n_s, n_t + 1),\n                     dimnames = list(state_names, state_names, 0:n_t))\n  \n  ##* Apply transition rewards\n  #* Apply disutility due to transition from Well to Sick\n  a_R_u_str[\"Well\", \"Sick\", ]      <- a_R_u_str[\"Well\", \"Sick\", ] - du_ws\n  #* Add transition cost per cycle due to transition from Well to Sick\n  a_R_c_str[\"Well\", \"Sick\", ]      <- a_R_c_str[\"Well\", \"Sick\", ] + ic_ws\n  #* Add transition cost  per cycle of dying from all non-dead states\n  a_R_c_str[-n_s, \"Dead\", ] <- a_R_c_str[-n_s, \"Dead\", ] + ic_D\n  \n  ###* Expected QALYs and costs for all transitions per cycle\n  #* QALYs = life years x QoL\n  a_Y_c_str <- a_A_str * a_R_c_str\n  a_Y_u_str <- a_A_str * a_R_u_str \n  \n  ###* Expected QALYs and costs per cycle\n  ##* Vector of QALYs and costs\n  v_qaly_str <- apply(a_Y_u_str, 3, sum) # sum the proportion of the cohort across transitions \n  v_cost_str <- apply(a_Y_c_str, 3, sum) # sum the proportion of the cohort across transitions\n  \n  ##* Discounted total expected QALYs and Costs per strategy\n  #* QALYs\n  v_tot_qaly[i] <- t(v_qaly_str) %*% (v_dwe)\n  #* Costs\n  v_tot_cost[i] <- t(v_cost_str) %*% (v_dwc)\n}\n```\n:::\n\n\n\nWe can then assess the model results, for example by looking at the total cost and QALY difference over the model time horizon.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv_tot_cost\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Control Treatment \n  32246.3  108303.2 \n```\n\n\n:::\n\n```{.r .cell-code}\nv_tot_qaly\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Control Treatment \n 7.794361  9.458081 \n```\n\n\n:::\n:::\n\n\n\nfrom which an estimate of the mean costs and QALYs difference between the two groups can be obtained as\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#experimental\nmu_c_exp <- v_tot_cost[2]\nmu_e_exp <- v_tot_qaly[2]\n\n#control\nmu_c_ctr <- v_tot_cost[1]\nmu_e_ctr <- v_tot_qaly[1]\n\nmu_c_diff <- mu_c_exp-mu_c_ctr\nmu_e_diff <- mu_e_exp-mu_e_ctr\n```\n:::\n\n\n\nand from this an estimate of the ICER can be obtained:\n\n$$\n\\text{ICER} = \\frac{1.0830317\\times 10^{5} - 3.2246297\\times 10^{4}}{9.4580812-7.7943606} =\\frac{7.6056876\\times 10^{4}}{1.6637206} = 4.571493\\times 10^{4}\n$$\n\nPerhaps next time I will focus on how to perform sensitivity analysis for these models. Thanks for following and till the next time!\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}