<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrea Gabrio">
<meta name="dcterms.date" content="2020-03-21">
<meta name="keywords" content="Software, Statistics, Stan">

<title>Item Response Theory Models (Stan) – Andrea Gabrio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Andrea Gabrio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../missing_data.html"> 
<span class="menu-text">Missing Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#parameter-logistic-model-1plm" id="toc-parameter-logistic-model-1plm" class="nav-link" data-scroll-target="#parameter-logistic-model-1plm">1 parameter logistic model (1PLM)</a>
  <ul class="collapse">
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data">Load the data</a></li>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model">Fit the model</a></li>
  <li><a href="#plot-the-item-characteristic-curves" id="toc-plot-the-item-characteristic-curves" class="nav-link" data-scroll-target="#plot-the-item-characteristic-curves">Plot the item characteristic curves</a></li>
  <li><a href="#plot-the-item-information-curves" id="toc-plot-the-item-information-curves" class="nav-link" data-scroll-target="#plot-the-item-information-curves">Plot the item information curves</a></li>
  <li><a href="#assess-fit" id="toc-assess-fit" class="nav-link" data-scroll-target="#assess-fit">Assess fit</a></li>
  <li><a href="#plot-ability-scores" id="toc-plot-ability-scores" class="nav-link" data-scroll-target="#plot-ability-scores">Plot ability scores</a></li>
  </ul></li>
  <li><a href="#parameter-logistic-model-2plm" id="toc-parameter-logistic-model-2plm" class="nav-link" data-scroll-target="#parameter-logistic-model-2plm">2 parameter logistic model (2PLM)</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-1" id="toc-fit-the-model-1" class="nav-link" data-scroll-target="#fit-the-model-1">Fit the model</a></li>
  <li><a href="#plot-the-item-characteristic-curves-1" id="toc-plot-the-item-characteristic-curves-1" class="nav-link" data-scroll-target="#plot-the-item-characteristic-curves-1">Plot the item characteristic curves</a></li>
  <li><a href="#plot-the-item-information-curves-1" id="toc-plot-the-item-information-curves-1" class="nav-link" data-scroll-target="#plot-the-item-information-curves-1">Plot the item information curves</a></li>
  <li><a href="#assess-fit-1" id="toc-assess-fit-1" class="nav-link" data-scroll-target="#assess-fit-1">Assess fit</a></li>
  <li><a href="#plot-ability-scores-1" id="toc-plot-ability-scores-1" class="nav-link" data-scroll-target="#plot-ability-scores-1">Plot ability scores</a></li>
  </ul></li>
  <li><a href="#parameter-logistic-model-3plm" id="toc-parameter-logistic-model-3plm" class="nav-link" data-scroll-target="#parameter-logistic-model-3plm">3 parameter logistic model (3PLM)</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-2" id="toc-fit-the-model-2" class="nav-link" data-scroll-target="#fit-the-model-2">Fit the model</a></li>
  <li><a href="#plot-the-item-characteristic-curves-2" id="toc-plot-the-item-characteristic-curves-2" class="nav-link" data-scroll-target="#plot-the-item-characteristic-curves-2">Plot the item characteristic curves</a></li>
  <li><a href="#plot-the-item-information-curves-2" id="toc-plot-the-item-information-curves-2" class="nav-link" data-scroll-target="#plot-the-item-information-curves-2">Plot the item information curves</a></li>
  <li><a href="#assess-fit-2" id="toc-assess-fit-2" class="nav-link" data-scroll-target="#assess-fit-2">Assess fit</a></li>
  <li><a href="#plot-ability-scores-2" id="toc-plot-ability-scores-2" class="nav-link" data-scroll-target="#plot-ability-scores-2">Plot ability scores</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Item Response Theory Models (Stan)</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Quarto</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">Academia</div>
    <div class="quarto-category">Software</div>
    <div class="quarto-category">Statistics</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://angabrio.github.io/agabriosite2/">Andrea Gabrio</a> <a href="mailto:a.gabrio@maastrichtuniversity.nl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-7650-4534" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.maastrichtuniversity.nl/research/methodology-and-statistics">
            Maastricht University
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 21, 2020</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p><span style="font-size: 85%">This tutorial will focus on the use of Bayesian estimation to fit simple linear regression models …</span></p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>Software, Statistics, Stan</p>
  </div>
</div>

</header>


<p>This tutorial will focus on the use of Bayesian estimation to fit simple linear regression models. <code>BUGS</code> (Bayesian inference Using <em>Gibbs Sampling</em>) is an algorithm and supporting language (resembling <code>R</code>) dedicated to performing the Gibbs sampling implementation of <em>Markov Chain Monte Carlo</em> (MCMC) method. Dialects of the <code>BUGS</code> language are implemented within three main projects:</p>
<ol type="1">
<li><p><strong>OpenBUGS</strong> - written in component pascal.</p></li>
<li><p><strong>JAGS</strong> - (Just Another Gibbs Sampler) - written in <code>C++</code>.</p></li>
<li><p><strong>Stan</strong> - a dedicated Bayesian modelling framework written in <code>C++</code> and implementing <em>Hamiltonian</em> MCMC samplers.</p></li>
</ol>
<p>Whilst the above programs can be used stand-alone, they do offer the rich data pre-processing and graphical capabilities of <code>R</code>, and thus, they are best accessed from within <code>R</code> itself. As such there are multiple packages devoted to interfacing with the various software implementations:</p>
<ul>
<li><p><em>R2OpenBUGS</em> - interfaces with <code>OpenBUGS</code></p></li>
<li><p><em>R2jags</em> - interfaces with <code>JAGS</code></p></li>
<li><p><em>rstan</em> - interfaces with <code>Stan</code></p></li>
</ul>
<p>This tutorial will demonstrate how to fit models in <code>Stan</code> (<span class="citation" data-cites="gelman2015stan">Gelman, Lee, and Guo (<a href="#ref-gelman2015stan" role="doc-biblioref">2015</a>)</span>) using the package <code>rstan</code> (<span class="citation" data-cites="rstanpackage">Stan Development Team (<a href="#ref-rstanpackage" role="doc-biblioref">2018</a>)</span>) as interface, which also requires to load some other packages.</p>
<section id="overview" class="level1">
<h1>Overview</h1>
<p>Item response theory (IRT) is a paradigm for investigating the relationship between an individual’s response to a single test item and their performance on an overall measure of the ability or trait that item was intended to measure. Many models exist in the IRT field for evaulating how well an item captures an underlying latent trait, but some of the most popular IRT models are <em>logistic IRT models</em> for dichotmous responses. In particular, the main types of models are:</p>
<p>1 <strong>1 parameter logistic model</strong></p>
<p>2 <strong>2 parameter logistic model</strong></p>
<p>3 <strong>3 parameter logistic model</strong></p>
<p>Throughout this tutorial, I assume that the reader has some basic understanding of IRT model and working knowledge of a software implementation of the <code>Stan</code> language. However, if this is not the case, excellent sources for learning IRT are <span class="citation" data-cites="baker2004item">Baker and Kim (<a href="#ref-baker2004item" role="doc-biblioref">2004</a>)</span>, who provide a mathematically detailed introduction to IRT, and <span class="citation" data-cites="hambleton1991fundamentals">Hambleton, Swaminathan, and Rogers (<a href="#ref-hambleton1991fundamentals" role="doc-biblioref">1991</a>)</span>, who give an intuitive introduction to the topic. For an in-depth description of how to implement different types of IRT models in <code>Stan</code>, I also refer to this very nice review of <span class="citation" data-cites="luo2018using">Luo and Jiao (<a href="#ref-luo2018using" role="doc-biblioref">2018</a>)</span> and this other online <a href="https://quantdev.ssri.psu.edu/sites/qdev/files/IRT_tutorial_FA17.html#3_2-parameter_logistic_(2pl)_irt_model">tutorial</a>.</p>
<p>At the core of all the IRT models presented in this tutorial is the <em>Item Response Function</em> (IRF). The IRF estimates the probability of getting item <span class="math inline">\(j\)</span> “correct” as a function of item characteristics and the <span class="math inline">\(i\)</span>-th individual’s latent trait/ability level (<span class="math inline">\(\theta_i\)</span>). These item response functions are defined by a logistic curve (i.e.&nbsp;an <span class="math inline">\(S\)</span>-shape from <span class="math inline">\(0-1\)</span>).</p>
</section>
<section id="parameter-logistic-model-1plm" class="level1">
<h1>1 parameter logistic model (1PLM)</h1>
<p>The 1PLM is used for data collected on <span class="math inline">\(n\)</span> individuals who have each given responses on <span class="math inline">\(p\)</span> different items. The items have binary outcomes, i.e.&nbsp;the items are scored as <span class="math inline">\(1\)</span> if correct and <span class="math inline">\(0\)</span> if not. The <span class="math inline">\(i\)</span>-th individual in the sample is assumed to have a latent ability <span class="math inline">\(\theta_i\)</span>, and the <span class="math inline">\(i\)</span>-th individual’s response on the <span class="math inline">\(j\)</span>-th item is a random variable <span class="math inline">\(Y_{ij}\)</span> with a Bernoulli distribution. The probability that the <span class="math inline">\(i\)</span>-th individual correctly answers the <span class="math inline">\(j\)</span>-th item (i.e.&nbsp;the probability that <span class="math inline">\(Y_{ij} = 1\)</span>) is assumed to have the following IRF form:</p>
<p><span class="math display">\[
p_{ij} = P(Y_{ij}=1 \mid \theta_i,\delta_j)=\frac{1}{1+\text{exp}(\theta_i-\delta_j)},
\]</span></p>
<p>where <span class="math inline">\(\delta_j\)</span> is the <em>difficulty parameter</em> for item <span class="math inline">\(j\)</span> of the test, and is assumed to be normally distributed according to some mean <span class="math inline">\(\mu_{\delta}\)</span> and standard deviation <span class="math inline">\(\sigma_{\delta}\)</span> which must be specified by the analyst. Each <em>latent ability parameter</em> <span class="math inline">\(\theta_i\)</span> is also assumed to be distributed according to a standard normal distribution.</p>
<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">Load the data</h2>
<p>I read in the data from the file <code>wideformat.csv</code>, which contains (simulated) data from <span class="math inline">\(n=1000\)</span> individuals taking a <span class="math inline">\(5\)</span>-item test. Items are coded <span class="math inline">\(1\)</span> for correct and <span class="math inline">\(0\)</span> for incorrect responses. When we get descriptives of the data, we see that the items differ in terms of the proportion of people who answered correctly, so we expect that we have some differences in item difficulty here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data_dicho<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"wideformat.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_dicho)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA        ID gender age Item.1 Item.2 Item.3 Item.4 Item.5
NA 1 person1   Male  40      0      0      0      0      0
NA 2 person2 Female  27      0      0      0      0      0
NA 3 person3   Male  13      0      0      0      0      0
NA 4 person4 Female  17      0      0      0      0      1
NA 5 person5 Female  30      0      0      0      0      1
NA 6 person6 Female  46      0      0      0      0      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check proportion of correct responses by item</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(data_dicho[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">2</span>, sum)<span class="sc">/</span><span class="fu">nrow</span>(data_dicho)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA Item.1 Item.2 Item.3 Item.4 Item.5 
NA  0.924  0.709  0.553  0.763  0.870</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summarise the data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_dicho)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA         vars    n   mean     sd median trimmed    mad min  max range  skew
NA ID*        1 1000 500.50 288.82  500.5  500.50 370.65   1 1000   999  0.00
NA gender*    2 1000   1.50   0.50    2.0    1.51   0.00   1    2     1 -0.02
NA age        3 1000  25.37  14.43   25.0   25.36  17.79   1   50    49  0.01
NA Item.1     4 1000   0.92   0.27    1.0    1.00   0.00   0    1     1 -3.20
NA Item.2     5 1000   0.71   0.45    1.0    0.76   0.00   0    1     1 -0.92
NA Item.3     6 1000   0.55   0.50    1.0    0.57   0.00   0    1     1 -0.21
NA Item.4     7 1000   0.76   0.43    1.0    0.83   0.00   0    1     1 -1.24
NA Item.5     8 1000   0.87   0.34    1.0    0.96   0.00   0    1     1 -2.20
NA         kurtosis   se
NA ID*        -1.20 9.13
NA gender*    -2.00 0.02
NA age        -1.21 0.46
NA Item.1      8.22 0.01
NA Item.2     -1.16 0.01
NA Item.3     -1.96 0.02
NA Item.4     -0.48 0.01
NA Item.5      2.83 0.01</code></pre>
</div>
</div>
</section>
<section id="fit-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model">Fit the model</h2>
<p>We fit the 1PLM to the data. First, I rename and preprocess the data to be passed to <code>Stan</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>data_dicho[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(Y)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ncol</span>(Y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>data_list<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="at">Y=</span>Y,<span class="at">n=</span>n,<span class="at">p=</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then I specify the model using the following <code>Stan</code> code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="st">"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0&gt; n;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0&gt; p;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0,upper=1&gt; Y[n,p];</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">vector[n] theta;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] delta;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">real mu_delta;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">real&lt;lower=0&gt; sigma_delta;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters{</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0,upper=1&gt;[p] prob[n];</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:n){</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1:p){</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">   prob[i,j] = inv_logit(theta[i] - delta[j]);</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">theta ~ normal(0,1);</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">delta ~ normal(mu_delta,sigma_delta);</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">mu_delta ~ normal(0,5);</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">sigma_delta ~ cauchy(0,5);</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:n){</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1:p){</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">   Y[i,j] ~ bernoulli(prob[i,j]);</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] loglik_y[n];</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] Y_rep[n];</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st"> for (i in 1: n){</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1: p){</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">    loglik_y[i,j] = bernoulli_lpmf(Y[i,j] | prob[i,j]);</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="st">    Y_rep[i,j] = bernoulli_rng(prob[i,j]); </span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="do">## write the model to a text file</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model1, <span class="at">con =</span> <span class="st">"model1PLM.stan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, I define the nodes (parameters and derivatives) to monitor and the chain parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"delta"</span>, <span class="st">"theta"</span>, <span class="st">"prob"</span>,<span class="st">"loglik_y"</span>,<span class="st">"Y_rep"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>nChains <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>burnInSteps <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>thinSteps <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>numSavedSteps <span class="ot">=</span> <span class="dv">2500</span>  <span class="co">#across all chains</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>nIter <span class="ot">=</span> <span class="fu">ceiling</span>(burnInSteps <span class="sc">+</span> (numSavedSteps <span class="sc">*</span> thinSteps)<span class="sc">/</span>nChains)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>nIter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] 1750</code></pre>
</div>
</div>
<p>Start the <code>Stan</code> model (check the model, load data into the model, specify the number of chains and compile the model). Run the <code>Stan</code> code via the <code>rstan</code> interface and the <code>stan</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3456</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>model1_stan<span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">data =</span> data_list, <span class="at">file =</span> <span class="st">"model1PLM.stan"</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">chains =</span> nChains, <span class="at">pars =</span> params, <span class="at">iter =</span> nIter, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">warmup =</span> burnInSteps, <span class="at">thin =</span> thinSteps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA 
NA SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
NA Chain 1: 
NA Chain 1: Gradient evaluation took 0.000686 seconds
NA Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 6.86 seconds.
NA Chain 1: Adjust your expectations accordingly!
NA Chain 1: 
NA Chain 1: 
NA Chain 1: Iteration:    1 / 1750 [  0%]  (Warmup)
NA Chain 1: Iteration:  175 / 1750 [ 10%]  (Warmup)
NA Chain 1: Iteration:  350 / 1750 [ 20%]  (Warmup)
NA Chain 1: Iteration:  501 / 1750 [ 28%]  (Sampling)
NA Chain 1: Iteration:  675 / 1750 [ 38%]  (Sampling)
NA Chain 1: Iteration:  850 / 1750 [ 48%]  (Sampling)
NA Chain 1: Iteration: 1025 / 1750 [ 58%]  (Sampling)
NA Chain 1: Iteration: 1200 / 1750 [ 68%]  (Sampling)
NA Chain 1: Iteration: 1375 / 1750 [ 78%]  (Sampling)
NA Chain 1: Iteration: 1550 / 1750 [ 88%]  (Sampling)
NA Chain 1: Iteration: 1725 / 1750 [ 98%]  (Sampling)
NA Chain 1: Iteration: 1750 / 1750 [100%]  (Sampling)
NA Chain 1: 
NA Chain 1:  Elapsed Time: 8.047 seconds (Warm-up)
NA Chain 1:                11.298 seconds (Sampling)
NA Chain 1:                19.345 seconds (Total)
NA Chain 1: 
NA 
NA SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
NA Chain 2: 
NA Chain 2: Gradient evaluation took 0.000512 seconds
NA Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 5.12 seconds.
NA Chain 2: Adjust your expectations accordingly!
NA Chain 2: 
NA Chain 2: 
NA Chain 2: Iteration:    1 / 1750 [  0%]  (Warmup)
NA Chain 2: Iteration:  175 / 1750 [ 10%]  (Warmup)
NA Chain 2: Iteration:  350 / 1750 [ 20%]  (Warmup)
NA Chain 2: Iteration:  501 / 1750 [ 28%]  (Sampling)
NA Chain 2: Iteration:  675 / 1750 [ 38%]  (Sampling)
NA Chain 2: Iteration:  850 / 1750 [ 48%]  (Sampling)
NA Chain 2: Iteration: 1025 / 1750 [ 58%]  (Sampling)
NA Chain 2: Iteration: 1200 / 1750 [ 68%]  (Sampling)
NA Chain 2: Iteration: 1375 / 1750 [ 78%]  (Sampling)
NA Chain 2: Iteration: 1550 / 1750 [ 88%]  (Sampling)
NA Chain 2: Iteration: 1725 / 1750 [ 98%]  (Sampling)
NA Chain 2: Iteration: 1750 / 1750 [100%]  (Sampling)
NA Chain 2: 
NA Chain 2:  Elapsed Time: 7.676 seconds (Warm-up)
NA Chain 2:                11.291 seconds (Sampling)
NA Chain 2:                18.967 seconds (Total)
NA Chain 2:</code></pre>
</div>
</div>
</section>
<section id="plot-the-item-characteristic-curves" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-item-characteristic-curves">Plot the item characteristic curves</h2>
<p><em>Item characteristic curves</em> (ICC) are the logistic curves which result from the fitted models (e.g.&nbsp;estimated item difficulty, plugged into the item response function). Latent trait/ability is plotted on the <span class="math inline">\(x\)</span>-axis (higher values represent hight ability). Probability of a “correct” answer (<span class="math inline">\(Y_{ij}=1\)</span>) to an item is plotted on the <span class="math inline">\(y\)</span>-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract parameters</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>model1_stan_par<span class="ot">&lt;-</span><span class="fu">extract</span>(model1_stan)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#see average value of item difficulty</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>diff<span class="ot">&lt;-</span>model1_stan_par<span class="sc">$</span>delta</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(diff,<span class="dv">2</span>,mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] -2.8607139 -1.0645087 -0.2625512 -1.3897885 -2.2186421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot icc for each individual with respect to each of the 5 items</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">apply</span>(model1_stan_par<span class="sc">$</span>theta, <span class="dv">2</span>, mean)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>prob<span class="ot">&lt;-</span><span class="fu">apply</span>(model1_stan_par<span class="sc">$</span>prob,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),mean)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,prob[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"probability of correct response"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">4</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">5</span>],<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that item <span class="math inline">\(3\)</span> is the most difficult item (it’s curve is farthest to the right), and item <span class="math inline">\(1\)</span> is the easiest (it’s curve is farthest to the left). The same conclusions can be drawn by checking the difficulty estimates above.</p>
</section>
<section id="plot-the-item-information-curves" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-item-information-curves">Plot the item information curves</h2>
<p><em>Item information curves</em> (IIC) show how much “information” about the latent trait ability an item gives. Mathematically, these are the <span class="math inline">\(1\)</span>st derivatives of the ICCs or, equivalently, to the product of the probability of correct and incorrect response. Item information curves peak at the difficulty value (point where the item has the highest discrimination), with less information at ability levels farther from the difficulty estimate. Practially speaking, we can see how a very difficult item will provide very little information about persons with low ability (because the item is already too hard), and very easy items will provide little information about persons with high ability levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot iic for each individual with respect to each of the 5 items</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>neg_prob<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>prob</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>information<span class="ot">&lt;-</span>prob<span class="sc">*</span>neg_prob</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,information[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"information"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information[,<span class="dv">4</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information[,<span class="dv">5</span>],<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similar to the ICCs, we see that item <span class="math inline">\(3\)</span> provides the most information about high ability levels (the peak of its IIC is farthest to the right) and item <span class="math inline">\(1\)</span> and <span class="math inline">\(5\)</span> provides the most information about lower ability levels (the peak of its IIC is farthest to the left). We have seen that all ICCs and IICs for the items have the same shape in the 1PL model (i.e.&nbsp;all items are equally good at providing information about the latent trait). In the 2PL and 3PL models, we will see that this does not have to be the case.</p>
<p>Next, we plot the information curve for the whole test. This is simply the sum of the individual IICs above. Ideally, we want a test which provides fairly good covereage of a wide range of latent ability levels. Otherwise, the test is only good at identifying a limited range of ability levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot iic for each individual with respect to whole test</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>information_test<span class="ot">&lt;-</span><span class="fu">apply</span>(information,<span class="dv">1</span>,sum)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,information_test, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"information (test)"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information_test,<span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(information_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
NA  0.5527  0.5698  0.7664  0.7753  0.9309  1.0789</code></pre>
</div>
</div>
<p>We see that this test provides the most information about low ability levels (the peak is around ability level <span class="math inline">\(-1.5\)</span>), and less information about very high ability levels.</p>
</section>
<section id="assess-fit" class="level2">
<h2 class="anchored" data-anchor-id="assess-fit">Assess fit</h2>
<p>We perform posterior predictive checks to test whether individual items fit the 1PLM by comparing quantities computed from the predictions of the model with those from the observed data. If these match reasonably well, then there is indication that the model has a good fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Y.rep<span class="ot">&lt;-</span>model1_stan_par<span class="sc">$</span>Y_rep</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Bar plot of y with yrep medians and uncertainty intervals superimposed on the bars</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">1</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">2</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">3</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">4</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">4</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">5</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">5</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-ability-scores" class="level2">
<h2 class="anchored" data-anchor-id="plot-ability-scores">Plot ability scores</h2>
<p>We can conclude by summarising and plotting the latent ability scores of the participants</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary stats for theta across both iterations and individuals</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(theta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
NA -2.0462862 -0.4876188  0.0766153 -0.0001134  0.6947979  0.7444596</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram and kernel density plot of theta averaged across iterations</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>dens.theta<span class="ot">&lt;-</span><span class="fu">density</span>(theta, <span class="at">bw=</span><span class="fl">0.3</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(theta, <span class="at">breaks =</span> <span class="dv">5</span>, <span class="at">prob =</span> T)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dens.theta, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that the mean of ability scores is around <span class="math inline">\(0\)</span>, and the standard deviation about <span class="math inline">\(1\)</span> (these are estimated ability scores are standardised).</p>
</section>
</section>
<section id="parameter-logistic-model-2plm" class="level1">
<h1>2 parameter logistic model (2PLM)</h1>
<p>In the 2PLM, the probability that the <span class="math inline">\(i\)</span>-th individual correctly answers the <span class="math inline">\(j\)</span>-th item (i.e.&nbsp;the probability that <span class="math inline">\(Y_{ij} = 1\)</span>) is assumed to have the following IRF form:</p>
<p><span class="math display">\[
p_{ij} = P(Y_{ij}=1 \mid \theta_i,\delta_j,\alpha_j)=\frac{1}{1+\text{exp}(\alpha_j(\theta_i-\delta_j))},
\]</span></p>
<p>where <span class="math inline">\(\alpha_j\)</span> is the <em>discrimination parameter</em> for item <span class="math inline">\(j\)</span> of the test, and is assumed to be positive and lognormally distributed according to some mean <span class="math inline">\(\mu_{\alpha}\)</span> and standard deviation <span class="math inline">\(\sigma_{\alpha}\)</span> which must be specified by the analyst. The item discriminability <span class="math inline">\(\alpha_j\)</span> indicates how well an item is able to discriminate between persons with different ability levels. Item discriminability is reflected in the steepness of the slope of the ICC.</p>
<section id="fit-the-model-1" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model-1">Fit the model</h2>
<p>We fit the 2PLM to the data using the following <code>Stan</code> code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">&lt;-</span><span class="st">"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0&gt; n;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0&gt; p;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0,upper=1&gt; Y[n,p];</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">vector[n] theta;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0&gt; [p] alpha;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] delta;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">real mu_delta;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">real&lt;lower=0&gt; sigma_alpha;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="st">real&lt;lower=0&gt; sigma_delta;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters{</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0,upper=1&gt;[p] prob[n];</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:n){</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1:p){</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="st">   prob[i,j] = inv_logit(alpha[j]*(theta[i] - delta[j]));</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="st">theta ~ normal(0,1);</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="st">delta ~ normal(mu_delta,sigma_delta);</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="st">mu_delta ~ normal(0,5);</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="st">sigma_delta ~ cauchy(0,5);</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="st">alpha ~ lognormal(0,sigma_alpha);</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="st">sigma_alpha ~ cauchy(0,5);</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:n){</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1:p){</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="st">   Y[i,j] ~ bernoulli(prob[i,j]);</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] loglik_y[n];</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] Y_rep[n];</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="st"> for (i in 1: n){</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1: p){</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="st">    loglik_y[i,j] = bernoulli_lpmf(Y[i,j] | prob[i,j]);</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="st">    Y_rep[i,j] = bernoulli_rng(prob[i,j]); </span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a><span class="do">## write the model to a text file</span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model2, <span class="at">con =</span> <span class="st">"model2PLM.stan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, I define the nodes (parameters and derivatives) to monitor and the chain parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"delta"</span>, <span class="st">"alpha"</span>,<span class="st">"theta"</span>, <span class="st">"prob"</span>,<span class="st">"loglik_y"</span>,<span class="st">"Y_rep"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>nChains <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>burnInSteps <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>thinSteps <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>numSavedSteps <span class="ot">=</span> <span class="dv">2500</span>  <span class="co">#across all chains</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>nIter <span class="ot">=</span> <span class="fu">ceiling</span>(burnInSteps <span class="sc">+</span> (numSavedSteps <span class="sc">*</span> thinSteps)<span class="sc">/</span>nChains)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>nIter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] 1750</code></pre>
</div>
</div>
<p>Start the <code>Stan</code> model (check the model, load data into the model, specify the number of chains and compile the model). Run the <code>Stan</code> code via the <code>rstan</code> interface and the <code>stan</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3456</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>model2_stan<span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">data =</span> data_list, <span class="at">file =</span> <span class="st">"model2PLM.stan"</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">chains =</span> nChains, <span class="at">pars =</span> params, <span class="at">iter =</span> nIter, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">warmup =</span> burnInSteps, <span class="at">thin =</span> thinSteps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA 
NA SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
NA Chain 1: 
NA Chain 1: Gradient evaluation took 0.000745 seconds
NA Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 7.45 seconds.
NA Chain 1: Adjust your expectations accordingly!
NA Chain 1: 
NA Chain 1: 
NA Chain 1: Iteration:    1 / 1750 [  0%]  (Warmup)
NA Chain 1: Iteration:  175 / 1750 [ 10%]  (Warmup)
NA Chain 1: Iteration:  350 / 1750 [ 20%]  (Warmup)
NA Chain 1: Iteration:  501 / 1750 [ 28%]  (Sampling)
NA Chain 1: Iteration:  675 / 1750 [ 38%]  (Sampling)
NA Chain 1: Iteration:  850 / 1750 [ 48%]  (Sampling)
NA Chain 1: Iteration: 1025 / 1750 [ 58%]  (Sampling)
NA Chain 1: Iteration: 1200 / 1750 [ 68%]  (Sampling)
NA Chain 1: Iteration: 1375 / 1750 [ 78%]  (Sampling)
NA Chain 1: Iteration: 1550 / 1750 [ 88%]  (Sampling)
NA Chain 1: Iteration: 1725 / 1750 [ 98%]  (Sampling)
NA Chain 1: Iteration: 1750 / 1750 [100%]  (Sampling)
NA Chain 1: 
NA Chain 1:  Elapsed Time: 17.619 seconds (Warm-up)
NA Chain 1:                49.041 seconds (Sampling)
NA Chain 1:                66.66 seconds (Total)
NA Chain 1: 
NA 
NA SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
NA Chain 2: 
NA Chain 2: Gradient evaluation took 0.001071 seconds
NA Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 10.71 seconds.
NA Chain 2: Adjust your expectations accordingly!
NA Chain 2: 
NA Chain 2: 
NA Chain 2: Iteration:    1 / 1750 [  0%]  (Warmup)
NA Chain 2: Iteration:  175 / 1750 [ 10%]  (Warmup)
NA Chain 2: Iteration:  350 / 1750 [ 20%]  (Warmup)
NA Chain 2: Iteration:  501 / 1750 [ 28%]  (Sampling)
NA Chain 2: Iteration:  675 / 1750 [ 38%]  (Sampling)
NA Chain 2: Iteration:  850 / 1750 [ 48%]  (Sampling)
NA Chain 2: Iteration: 1025 / 1750 [ 58%]  (Sampling)
NA Chain 2: Iteration: 1200 / 1750 [ 68%]  (Sampling)
NA Chain 2: Iteration: 1375 / 1750 [ 78%]  (Sampling)
NA Chain 2: Iteration: 1550 / 1750 [ 88%]  (Sampling)
NA Chain 2: Iteration: 1725 / 1750 [ 98%]  (Sampling)
NA Chain 2: Iteration: 1750 / 1750 [100%]  (Sampling)
NA Chain 2: 
NA Chain 2:  Elapsed Time: 16.85 seconds (Warm-up)
NA Chain 2:                25.604 seconds (Sampling)
NA Chain 2:                42.454 seconds (Total)
NA Chain 2:</code></pre>
</div>
</div>
</section>
<section id="plot-the-item-characteristic-curves-1" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-item-characteristic-curves-1">Plot the item characteristic curves</h2>
<p><em>Item characteristic curves</em> (ICC) are the logistic curves which result from the fitted models (e.g.&nbsp;estimated item difficulty, plugged into the item response function). Latent trait/ability is plotted on the <span class="math inline">\(x\)</span>-axis (higher values represent hight ability). Probability of a “correct” answer (<span class="math inline">\(Y_{ij}=1\)</span>) to an item is plotted on the <span class="math inline">\(y\)</span>-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract parameters</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>model2_stan_par<span class="ot">&lt;-</span><span class="fu">extract</span>(model2_stan)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>discr<span class="ot">&lt;-</span>model2_stan_par<span class="sc">$</span>alpha</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>diff<span class="ot">&lt;-</span>model2_stan_par<span class="sc">$</span>delta</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#see average value of item difficulty</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(diff,<span class="dv">2</span>,mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] -3.1999792 -1.3773558 -0.3093908 -1.8061242 -2.7793706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see average value of item discriminability</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(discr,<span class="dv">2</span>,mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] 0.9180807 0.7605854 0.8462632 0.7522866 0.7916501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot icc for each individual with respect to each of the 5 items</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">apply</span>(model2_stan_par<span class="sc">$</span>theta, <span class="dv">2</span>, mean)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>prob<span class="ot">&lt;-</span><span class="fu">apply</span>(model2_stan_par<span class="sc">$</span>prob,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),mean)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,prob[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"probability of correct response"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">4</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">5</span>],<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Unlike the ICCs for the 1PLM, the ICCs for the 2PLM do not all have the same shape. Item curves which are more “spread out” indicate lower discriminability (i.e.&nbsp;that individuals of a range of ability levels have some probability of getting the item correct). Compare this to an item with high discriminability (steep slope): for this item, we have a better estimate of the individual’s latent ability based on whether they got the question right or wrong. Because of the differing slopes, the rank-order of item difficulty changes across different latent ability levels. We can see that item <span class="math inline">\(3\)</span> is still the most difficult item (i.e.&nbsp;lowest probability of getting correct for most latent trait values, up until about <span class="math inline">\(\theta=0.2\)</span>). Items <span class="math inline">\(1\)</span> and <span class="math inline">\(5\)</span> are the easiest.</p>
</section>
<section id="plot-the-item-information-curves-1" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-item-information-curves-1">Plot the item information curves</h2>
<p><em>Item information curves</em> (IIC) show how much “information” about the latent trait ability an item gives. Mathematically, these are the <span class="math inline">\(1\)</span>st derivatives of the ICCs or, equivalently, to the product of the probability of correct and incorrect response. Item information curves peak at the difficulty value (point where the item has the highest discrimination), with less information at ability levels farther from the difficulty estimate. Practially speaking, we can see how a very difficult item will provide very little information about persons with low ability (because the item is already too hard), and very easy items will provide little information about persons with high ability levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot iic for each individual with respect to each of the 5 items</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>neg_prob<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>prob</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>information<span class="ot">&lt;-</span>prob<span class="sc">*</span>neg_prob</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>information2<span class="ot">&lt;-</span>information<span class="sc">*</span>(<span class="fu">apply</span>(discr,<span class="dv">2</span>,mean))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,information2[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"information"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information2[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information2[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information2[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information2[,<span class="dv">4</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information2[,<span class="dv">5</span>],<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The item IICs demonstrate that some items provide more information about latent ability for different ability levels. The higher the item discriminability estimate, the more information an item provides about ability levels around the point where there is a <span class="math inline">\(50\%\)</span> chance of getting the item right (i.e.&nbsp;the steepest point in the ICC slope). For example, item <span class="math inline">\(3\)</span> (orange) clearly provides the most information at high ability levels, around <span class="math inline">\(\theta=-0.5\)</span>, but almost no information about low ability levels (<span class="math inline">\(&lt; -1\)</span>) because the item is already too hard for those participants. In contrast, item <span class="math inline">\(1\)</span> (red), which has low discriminability, doesn’t give very much information overall, but covers a wide range of ability levels.</p>
<p>Next, we plot the item information curve for the whole test. This is the sum of all the item IICs above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot iic for each individual with respect to whole test</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>information_test<span class="ot">&lt;-</span><span class="fu">apply</span>(information2,<span class="dv">1</span>,sum)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,information_test, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"information (test)"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,information_test,<span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(information_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
NA  0.3521  0.4463  0.5206  0.5280  0.5837  0.9238</code></pre>
</div>
</div>
<p>The IIC for the whole test shows that the test provides the most information for slightly-lower-than average ability levels (about <span class="math inline">\(\theta=-1\)</span>), but does not provide much information about extremely high ability levels.</p>
</section>
<section id="assess-fit-1" class="level2">
<h2 class="anchored" data-anchor-id="assess-fit-1">Assess fit</h2>
<p>Next, we check how well the 2PLM fits the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Y.rep<span class="ot">&lt;-</span>model2_stan_par<span class="sc">$</span>Y_rep</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Bar plot of y with yrep medians and uncertainty intervals superimposed on the bars</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">1</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">2</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">3</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">4</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">4</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">5</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">5</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also compare the fit of the 1PLM and 2PLM using relative measures of fit or <em>information criteria</em>. These are computed based on the deviance and a penalty for model complexity called the effective number of parameters <span class="math inline">\(p\)</span>. Here we consider two Bayesian measures known as the <em>Widely Applicable</em> (WAIC) and <em>Leave One Out</em> (LOOIC) Information Criterion, which can be easily obtained through the functions <code>waic</code> and <code>loo</code> in the package <code>loo</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#extract log-likelihood</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>loglik_m1<span class="ot">&lt;-</span>model1_stan_par<span class="sc">$</span>loglik_y</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>loglik_m2<span class="ot">&lt;-</span>model2_stan_par<span class="sc">$</span>loglik_y</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#waic</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>waic_m1<span class="ot">&lt;-</span><span class="fu">waic</span>(loglik_m1)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>waic_m2<span class="ot">&lt;-</span><span class="fu">waic</span>(loglik_m2)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#looic</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>looic_m1<span class="ot">&lt;-</span><span class="fu">loo</span>(loglik_m1)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>looic_m2<span class="ot">&lt;-</span><span class="fu">loo</span>(loglik_m2)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">#compare</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>table_waic<span class="ot">&lt;-</span><span class="fu">rbind</span>(waic_m1<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>],waic_m2<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>])</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>table_looic<span class="ot">&lt;-</span><span class="fu">rbind</span>(looic_m1<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>],looic_m2<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>])</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table_waic)<span class="ot">&lt;-</span><span class="fu">rownames</span>(table_looic)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"1PLM"</span>,<span class="st">"2PLM"</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(table_waic,table_looic), <span class="st">"pandoc"</span>, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">p_waic</th>
<th style="text-align: center;">waic</th>
<th style="text-align: center;">p_loo</th>
<th style="text-align: center;">looic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1PLM</td>
<td style="text-align: center;">1.528685</td>
<td style="text-align: center;">6.524715</td>
<td style="text-align: center;">1.872122</td>
<td style="text-align: center;">7.211591</td>
</tr>
<tr class="even">
<td>2PLM</td>
<td style="text-align: center;">1.425271</td>
<td style="text-align: center;">6.459973</td>
<td style="text-align: center;">1.707341</td>
<td style="text-align: center;">7.024112</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Both criteria suggest that the 2PLM has a slightly better fit to the data.</p>
</section>
<section id="plot-ability-scores-1" class="level2">
<h2 class="anchored" data-anchor-id="plot-ability-scores-1">Plot ability scores</h2>
<p>Plot the density curve of the estimated ability scores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary stats for theta across both iterations and individuals</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(theta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
NA -1.9620636 -0.4347622  0.0659988  0.0006122  0.6347629  0.6738680</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram and kernel density plot of theta averaged across iterations</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>dens.theta<span class="ot">&lt;-</span><span class="fu">density</span>(theta, <span class="at">bw=</span><span class="fl">0.3</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(theta, <span class="at">breaks =</span> <span class="dv">5</span>, <span class="at">prob =</span> T)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dens.theta, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that the mean of ability scores is around <span class="math inline">\(0\)</span>, and the standard deviation about <span class="math inline">\(1\)</span> (these are estimated ability scores are standardised).</p>
</section>
</section>
<section id="parameter-logistic-model-3plm" class="level1">
<h1>3 parameter logistic model (3PLM)</h1>
<p>In the 3PLM, the probability that the <span class="math inline">\(i\)</span>-th individual correctly answers the <span class="math inline">\(j\)</span>-th item (i.e.&nbsp;the probability that <span class="math inline">\(Y_{ij} = 1\)</span>) is assumed to have the following IRF form:</p>
<p><span class="math display">\[
p_{ij} = P(Y_{ij}=1 \mid \theta_i,\delta_j,\alpha_j,\eta_j)=\eta_j + (1-\eta_j) \frac{1}{1+\text{exp}(\alpha_j(\theta_i-\delta_j))},
\]</span></p>
<p>where <span class="math inline">\(\eta_j\)</span> is the <em>guessing parameter</em>. Under this model, individuals with zero ability have a nonzero chance of endorsing any item, just by guessing randomly. The guessing parameter is reflected in the <span class="math inline">\(y\)</span>-intercept (i.e.&nbsp;probability) of the ICC. The parameter is normally distributed according to some mean <span class="math inline">\(\mu_{\eta}\)</span> and standard deviation <span class="math inline">\(\sigma_{\eta}\)</span> which must be specified by the analyst.</p>
<section id="fit-the-model-2" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model-2">Fit the model</h2>
<p>We fit the 3PLM to the data using the following <code>Stan</code> code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>model3<span class="ot">&lt;-</span><span class="st">"</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0&gt; n;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0&gt; p;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="st">int&lt;lower=0,upper=1&gt; Y[n,p];</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="st">vector[n] theta;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0&gt; [p] alpha;</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] delta;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0,upper=1&gt;[p] eta; //item pseudo-guessing</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="st">real mu_delta;</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="st">real&lt;lower=0&gt; sigma_alpha;</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="st">real&lt;lower=0&gt; sigma_delta;</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters{</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0,upper=1&gt;[p] prob_star[n];</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="st">vector&lt;lower=0,upper=1&gt;[p] prob[n];</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:n){</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1:p){</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="st">   prob_star[i,j] = inv_logit(alpha[j]*(theta[i] - delta[j]));</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="st">   prob[i, j] = eta[j] + (1-eta[j])*prob_star[i,j]; </span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="st">theta ~ normal(0,1);</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="st">delta ~ normal(mu_delta,sigma_delta);</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="st">mu_delta ~ normal(0,5);</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="st">sigma_delta ~ cauchy(0,5);</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="st">alpha ~ lognormal(0,sigma_alpha);</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="st">sigma_alpha ~ cauchy(0,5);</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="st">eta ~ beta(5,23);</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:n){</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1:p){</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="st">   Y[i,j] ~ bernoulli(prob[i,j]);</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] loglik_y[n];</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="st">vector[p] Y_rep[n];</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="st"> for (i in 1: n){</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="st">  for (j in 1: p){</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a><span class="st">    loglik_y[i,j] = bernoulli_lpmf(Y[i,j] | prob[i,j]);</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="st">    Y_rep[i,j] = bernoulli_rng(prob[i,j]); </span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="do">## write the model to a text file</span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model3, <span class="at">con =</span> <span class="st">"model3PLM.stan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, I define the nodes (parameters and derivatives) to monitor and the chain parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"delta"</span>, <span class="st">"alpha"</span>, <span class="st">"eta"</span>,<span class="st">"theta"</span>, <span class="st">"prob"</span>,<span class="st">"loglik_y"</span>,<span class="st">"Y_rep"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>nChains <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>burnInSteps <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>thinSteps <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>numSavedSteps <span class="ot">=</span> <span class="dv">2500</span>  <span class="co">#across all chains</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>nIter <span class="ot">=</span> <span class="fu">ceiling</span>(burnInSteps <span class="sc">+</span> (numSavedSteps <span class="sc">*</span> thinSteps)<span class="sc">/</span>nChains)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>nIter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] 1750</code></pre>
</div>
</div>
<p>Start the <code>Stan</code> model (check the model, load data into the model, specify the number of chains and compile the model). Run the <code>Stan</code> code via the <code>rstan</code> interface and the <code>stan</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3456</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>model3_stan<span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">data =</span> data_list, <span class="at">file =</span> <span class="st">"model3PLM.stan"</span>, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">chains =</span> nChains, <span class="at">pars =</span> params, <span class="at">iter =</span> nIter, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">warmup =</span> burnInSteps, <span class="at">thin =</span> thinSteps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA 
NA SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
NA Chain 1: 
NA Chain 1: Gradient evaluation took 0.000959 seconds
NA Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 9.59 seconds.
NA Chain 1: Adjust your expectations accordingly!
NA Chain 1: 
NA Chain 1: 
NA Chain 1: Iteration:    1 / 1750 [  0%]  (Warmup)
NA Chain 1: Iteration:  175 / 1750 [ 10%]  (Warmup)
NA Chain 1: Iteration:  350 / 1750 [ 20%]  (Warmup)
NA Chain 1: Iteration:  501 / 1750 [ 28%]  (Sampling)
NA Chain 1: Iteration:  675 / 1750 [ 38%]  (Sampling)
NA Chain 1: Iteration:  850 / 1750 [ 48%]  (Sampling)
NA Chain 1: Iteration: 1025 / 1750 [ 58%]  (Sampling)
NA Chain 1: Iteration: 1200 / 1750 [ 68%]  (Sampling)
NA Chain 1: Iteration: 1375 / 1750 [ 78%]  (Sampling)
NA Chain 1: Iteration: 1550 / 1750 [ 88%]  (Sampling)
NA Chain 1: Iteration: 1725 / 1750 [ 98%]  (Sampling)
NA Chain 1: Iteration: 1750 / 1750 [100%]  (Sampling)
NA Chain 1: 
NA Chain 1:  Elapsed Time: 15.626 seconds (Warm-up)
NA Chain 1:                29.036 seconds (Sampling)
NA Chain 1:                44.662 seconds (Total)
NA Chain 1: 
NA 
NA SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
NA Chain 2: 
NA Chain 2: Gradient evaluation took 0.000674 seconds
NA Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 6.74 seconds.
NA Chain 2: Adjust your expectations accordingly!
NA Chain 2: 
NA Chain 2: 
NA Chain 2: Iteration:    1 / 1750 [  0%]  (Warmup)
NA Chain 2: Iteration:  175 / 1750 [ 10%]  (Warmup)
NA Chain 2: Iteration:  350 / 1750 [ 20%]  (Warmup)
NA Chain 2: Iteration:  501 / 1750 [ 28%]  (Sampling)
NA Chain 2: Iteration:  675 / 1750 [ 38%]  (Sampling)
NA Chain 2: Iteration:  850 / 1750 [ 48%]  (Sampling)
NA Chain 2: Iteration: 1025 / 1750 [ 58%]  (Sampling)
NA Chain 2: Iteration: 1200 / 1750 [ 68%]  (Sampling)
NA Chain 2: Iteration: 1375 / 1750 [ 78%]  (Sampling)
NA Chain 2: Iteration: 1550 / 1750 [ 88%]  (Sampling)
NA Chain 2: Iteration: 1725 / 1750 [ 98%]  (Sampling)
NA Chain 2: Iteration: 1750 / 1750 [100%]  (Sampling)
NA Chain 2: 
NA Chain 2:  Elapsed Time: 17.019 seconds (Warm-up)
NA Chain 2:                29.021 seconds (Sampling)
NA Chain 2:                46.04 seconds (Total)
NA Chain 2:</code></pre>
</div>
</div>
</section>
<section id="plot-the-item-characteristic-curves-2" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-item-characteristic-curves-2">Plot the item characteristic curves</h2>
<p><em>Item characteristic curves</em> (ICC) are the logistic curves which result from the fitted models (e.g.&nbsp;estimated item difficulty, plugged into the item response function). Latent trait/ability is plotted on the <span class="math inline">\(x\)</span>-axis (higher values represent hight ability). Probability of a “correct” answer (<span class="math inline">\(Y_{ij}=1\)</span>) to an item is plotted on the <span class="math inline">\(y\)</span>-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract parameters</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>model3_stan_par<span class="ot">&lt;-</span><span class="fu">extract</span>(model3_stan)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>discr<span class="ot">&lt;-</span>model3_stan_par<span class="sc">$</span>alpha</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>diff<span class="ot">&lt;-</span>model3_stan_par<span class="sc">$</span>delta</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>gues<span class="ot">&lt;-</span>model3_stan_par<span class="sc">$</span>eta</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">#see average value of item difficulty</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(diff,<span class="dv">2</span>,mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] -2.8000531 -0.7982283  0.1709581 -1.2011374 -2.1901744</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see average value of item discriminability</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(discr,<span class="dv">2</span>,mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] 0.9504686 0.8863304 1.0198040 0.8720698 0.8853051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see average value of item guessing</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(gues,<span class="dv">2</span>,mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA [1] 0.1894722 0.1841677 0.1635017 0.1926284 0.1920851</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot icc for each individual with respect to each of the 5 items</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">apply</span>(model3_stan_par<span class="sc">$</span>theta, <span class="dv">2</span>, mean)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>prob<span class="ot">&lt;-</span><span class="fu">apply</span>(model3_stan_par<span class="sc">$</span>prob,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),mean)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,prob[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"probability of correct response"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">4</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(theta,prob[,<span class="dv">5</span>],<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The slopes of the ICCs look very similar to those of the 2PLM. We can see that all items have <span class="math inline">\(y\)</span>-intercepts greater than zero, so that even at very low ability levels, there is some chance of getting these items correct (via guessing).</p>
</section>
<section id="plot-the-item-information-curves-2" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-item-information-curves-2">Plot the item information curves</h2>
<p><em>Item information curves</em> (IIC) show how much “information” about the latent trait ability an item gives. Mathematically, these are the <span class="math inline">\(1\)</span>st derivatives of the ICCs or, equivalently, to the product of the probability of correct and incorrect response. Item information curves peak at the difficulty value (point where the item has the highest discrimination), with less information at ability levels farther from the difficulty estimate. Practially speaking, we can see how a very difficult item will provide very little information about persons with low ability (because the item is already too hard), and very easy items will provide little information about persons with high ability levels.</p>
<p>Here I plot the IICs using points, rather than lines, to better display the patterns of the individuals, which vary substantially according to whether the item was correctly chosen due to chance or not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot iic for each individual with respect to each of the 5 items</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>neg_prob<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>prob</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>information.p1<span class="ot">&lt;-</span>neg_prob<span class="sc">/</span>prob</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>information.p2<span class="ot">&lt;-</span>(prob<span class="sc">-</span><span class="fu">apply</span>(gues,<span class="dv">2</span>,mean))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">apply</span>(gues,<span class="dv">2</span>,mean))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>information3<span class="ot">&lt;-</span>(<span class="fu">apply</span>(discr,<span class="dv">2</span>,mean))<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(information.p2)<span class="sc">*</span>(information.p1)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,information3[,<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"information"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(theta,information3[,<span class="dv">1</span>],<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(theta,information3[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(theta,information3[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(theta,information3[,<span class="dv">4</span>],<span class="at">col=</span><span class="st">"green"</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(theta,information3[,<span class="dv">5</span>],<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"orange"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next, we plot the item information curve for the whole test. This is the sum of all the item IICs above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot iic for each individual with respect to whole test</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>information_test<span class="ot">&lt;-</span><span class="fu">apply</span>(information3,<span class="dv">1</span>,sum)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta,information_test, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylab =</span> <span class="st">"information (test)"</span>, <span class="at">xlab=</span><span class="st">"ability"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(theta,information_test,<span class="at">col=</span><span class="st">"black"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(information_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
NA  0.4050  0.4876  0.5259  0.5430  0.5794  0.7800</code></pre>
</div>
</div>
</section>
<section id="assess-fit-2" class="level2">
<h2 class="anchored" data-anchor-id="assess-fit-2">Assess fit</h2>
<p>Next, we check how well the 3PLM fits the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Y.rep<span class="ot">&lt;-</span>model3_stan_par<span class="sc">$</span>Y_rep</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Bar plot of y with yrep medians and uncertainty intervals superimposed on the bars</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">1</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">2</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">3</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">4</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">4</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_bars</span>(Y[,<span class="dv">5</span>],Y.rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,,<span class="dv">5</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Item 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also compare the fit of the 1PLM, 2PLM and 3PLM using relative measures of fit or <em>information criteria</em>. These are computed based on the deviance and a penalty for model complexity called the effective number of parameters <span class="math inline">\(p\)</span>. Here we consider two Bayesian measures known as the <em>Widely Applicable</em> (WAIC) and <em>Leave One Out</em> (LOOIC) Information Criterion, which can be easily obtained through the functions <code>waic</code> and <code>loo</code> in the package <code>loo</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract log-likelihood</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>loglik_m3<span class="ot">&lt;-</span>model3_stan_par<span class="sc">$</span>loglik_y</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#waic</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>waic_m3<span class="ot">&lt;-</span><span class="fu">waic</span>(loglik_m3)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co">#looic</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>looic_m3<span class="ot">&lt;-</span><span class="fu">loo</span>(loglik_m3)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">#compare</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>table_waic<span class="ot">&lt;-</span><span class="fu">rbind</span>(waic_m1<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>],waic_m2<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>],waic_m3<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>])</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>table_looic<span class="ot">&lt;-</span><span class="fu">rbind</span>(looic_m1<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>],looic_m2<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>],looic_m3<span class="sc">$</span>estimates[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span>])</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table_waic)<span class="ot">&lt;-</span><span class="fu">rownames</span>(table_looic)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"1PLM"</span>,<span class="st">"2PLM"</span>,<span class="st">"3PLM"</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(table_waic,table_looic), <span class="st">"pandoc"</span>, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">p_waic</th>
<th style="text-align: center;">waic</th>
<th style="text-align: center;">p_loo</th>
<th style="text-align: center;">looic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1PLM</td>
<td style="text-align: center;">1.528685</td>
<td style="text-align: center;">6.524715</td>
<td style="text-align: center;">1.872122</td>
<td style="text-align: center;">7.211591</td>
</tr>
<tr class="even">
<td>2PLM</td>
<td style="text-align: center;">1.425271</td>
<td style="text-align: center;">6.459973</td>
<td style="text-align: center;">1.707341</td>
<td style="text-align: center;">7.024112</td>
</tr>
<tr class="odd">
<td>3PLM</td>
<td style="text-align: center;">1.404317</td>
<td style="text-align: center;">6.431826</td>
<td style="text-align: center;">1.696826</td>
<td style="text-align: center;">7.016845</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Both criteria suggest that both 1PLM and 2PLM have a better fit to the data than 3PLM.</p>
</section>
<section id="plot-ability-scores-2" class="level2">
<h2 class="anchored" data-anchor-id="plot-ability-scores-2">Plot ability scores</h2>
<p>Plot the density curve of the estimated ability scores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary stats for theta across both iterations and individuals</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(theta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NA       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
NA -1.8453432 -0.4371787  0.0632952  0.0001144  0.6473378  0.7082924</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram and kernel density plot of theta averaged across iterations</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>dens.theta<span class="ot">&lt;-</span><span class="fu">density</span>(theta, <span class="at">bw=</span><span class="fl">0.3</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(theta, <span class="at">breaks =</span> <span class="dv">5</span>, <span class="at">prob =</span> T)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dens.theta, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that the mean of ability scores is around <span class="math inline">\(0\)</span>, and the standard deviation about <span class="math inline">\(1\)</span> (these are estimated ability scores are standardised).</p>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>The use of <code>Stan</code> software to estimate IRT models allows the user to alter existing code to fit new variations of current models that cannot be fit in existing software packages. For example, longitudinal or multilevel data can easily be accommodated by small changes to existing <code>Stan</code> code. The <code>Stan</code> software takes care of the “grunt work” involved in estimating model parameters by constructing an MCMC algorithm to sample from the posterior distribution. Using <code>Stan</code> frees the user to experiment with different models that may be more appropriate for specialised data than the models that can currently be fit in other software packages. Of course, more complicated models involve more parameters than simpler models, and the analyst must specify prior distributions for these new parameters. This is a small price to pay, however, for the flexibility that the Bayesian framework and <code>Stan</code> software provide.</p>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-baker2004item" class="csl-entry" role="listitem">
Baker, Frank B, and Seock-Ho Kim. 2004. <em>Item Response Theory: Parameter Estimation Techniques</em>. CRC Press.
</div>
<div id="ref-gelman2015stan" class="csl-entry" role="listitem">
Gelman, Andrew, Daniel Lee, and Jiqiang Guo. 2015. <span>“Stan: A Probabilistic Programming Language for Bayesian Inference and Optimization.”</span> <em>Journal of Educational and Behavioral Statistics</em> 40 (5): 530–43.
</div>
<div id="ref-hambleton1991fundamentals" class="csl-entry" role="listitem">
Hambleton, Ronald K, Hariharan Swaminathan, and H Jane Rogers. 1991. <em>Fundamentals of Item Response Theory</em>. Sage.
</div>
<div id="ref-luo2018using" class="csl-entry" role="listitem">
Luo, Yong, and Hong Jiao. 2018. <span>“Using the Stan Program for Bayesian Item Response Theory.”</span> <em>Educational and Psychological Measurement</em> 78 (3): 384–408.
</div>
<div id="ref-rstanpackage" class="csl-entry" role="listitem">
Stan Development Team. 2018. <span>“<span>RStan</span>: The <span>R</span> Interface to <span>Stan</span>.”</span> <a href="http://mc-stan.org/">http://mc-stan.org/</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Andrea Gabrio</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>