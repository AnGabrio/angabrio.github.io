<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrea Gabrio">
<meta name="dcterms.date" content="2025-06-15">

<title>Healthcare resourse use data in economic evaluations – Andrea Gabrio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Andrea Gabrio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../missing_data.html"> 
<span class="menu-text">Missing Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-hru" id="toc-sec-hru" class="nav-link active" data-scroll-target="#sec-hru">Resource use data</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Healthcare resourse use data in economic evaluations</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Quarto</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">Academia</div>
    <div class="quarto-category">Missing Data</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://angabrio.github.io/agabriosite2/">Andrea Gabrio</a> <a href="https://orcid.org/0000-0002-7650-4534" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.maastrichtuniversity.nl/research/methodology-and-statistics">
            Maastricht University
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Good day folks, and welcome back for a new update of my blog. Since in this period I am quite busy (I am actually moving so you can imagine the stress!), today I would like to talk about a “simpler” and more practical topic compared to what you normally see on this blog: what type and in which way are cost data obtained for individuals involved in economic evaluations? well, perhaps unsurprisingly, cost data do not exist per se but are instead attached to the use of a given service or produce which, in the context of economic evaluations, usually refer to some type of <strong>healthcare service</strong> or <strong>healthcare resource use</strong> (e.g.&nbsp;GP visit, hospital appointment, injections received, etc …) and the amount of each of these services that is “consumed” by the individual over a given time period.</p>
<p>I will only briefly touch on this subject since I do not possess an extensive knowledge about the reasons and problems associated with the selection of specific types of healthcare resource use for a trial, but I still think it is important for an analyst to be aware of how these type of data are collected, the possible alternatives that could be considered, and the related advantages and disadvantages when it comes down to collect, analyse and interpret the results of an analysis based on them.</p>
<section id="sec-hru" class="level1">
<h1>Resource use data</h1>
<p>In the context of trial-based analysis, healthcare resource-use (HRU) data consist in the resources/services consumed by the person or population with the health condition of interest for the economic evaluation. For example, common types of HRU information include number and type of visits to hospital (e.g.&nbsp;inpatient, outpatient, critical care) and any medications prescribed (e.g.&nbsp;type of drug, dose and duration of treatment). Resource-use information can, in principle, be analysed in its own right, although due to costs being one of the key aspects for economic evaluations, HRU data are often used only to generate costs which, instead, often represent the main focus of the economic analysis.</p>
<p>Identification of which type of resource use data to include in an economic evaluation requires consideration of the perspective of the study, the types of resource use likely to be relevant to the comparison <span class="citation" data-cites="drummond2015methods">(<a href="#ref-drummond2015methods" role="doc-biblioref">Drummond et al. 2015</a>)</span>, and the target audience or user of the study <span class="citation" data-cites="gold1996cost">(<a href="#ref-gold1996cost" role="doc-biblioref">Gold 1996</a>)</span>. Knowledge is required about the resources needed to perform the intervention as well as of the disease process itself, especially during and after treatment. It may also be important to identify whether the way in which care is delivered varies between different centres or settings: for example, some hospitals may routinely perform a procedure on a day-case basis, while others may require an overnight stay <span class="citation" data-cites="gray2010applied">(<a href="#ref-gray2010applied" role="doc-biblioref">Gray et al. 2010</a>)</span>.</p>
<p>The type and number of different resources used can be collected in a number of ways including patient files, administrative databases, questionnaires, or the relevant literature. The specific method used to collect HRU data will be dependent on the type of economic evaluation, whether access to patient level data is possible, and the costs and benefits associated with each option for collecting resource use information. For example, for trial-based economic evaluations, data on resource quantities, such as types and amounts of drugs administered, is typically collected via case report forms for the trial. Alternatively, in case of a stand-alone economic evaluation, resource quantities could be estimated from data systems, such as hospital records or patient case notes. For some items of resource use, such as health visitor contacts, the difficulty of accessing routinely recorded information may impose to ask patients to provide estimates of their use of these resource items, for example by completing questionnaires, giving interviews, or keeping diaries.</p>
<p>In the UK, the <em>Client Service Receipt Inventory</em>(CSRI) is a commonly used example of research instrument used at multiple points within a study which is aimed at capturing resource use patterns and related costs over time <span class="citation" data-cites="beecham2001costing">(<a href="#ref-beecham2001costing" role="doc-biblioref">Beecham and Knapp 2001</a>)</span>. Although a fully standardised or universally applicable form does not exist, the CSRI is often characterised by questions related to common thematic areas: background client information, accommodation, employment history, types of service used (e.g.&nbsp;hospital, primary care, etc.), and informal care. In the Netherlands, the <em>iMTA Medical Consumption Questionnaire</em> (iMCQ) is the most popular instrument for measuring medical consumption for economic evaluations alongside clinical trials <span class="citation" data-cites="rotterdam2018imta">(<a href="#ref-rotterdam2018imta" role="doc-biblioref">Rotterdam 2018</a>)</span>. The iMCQ includes questions related to frequently occurring contacts with health care providers and is frequently combined with the <em>iMTA Productivity Cost Questionnaire</em> (iPCQ) as a short generic measurement instrument for measuring and valuing productivity losses <span class="citation" data-cites="bouwmans2015imta">(<a href="#ref-bouwmans2015imta" role="doc-biblioref">Bouwmans et al. 2015</a>)</span>. In the example, shown in <a href="#fig-imcq" class="quarto-xref">Figure&nbsp;1</a>, of a typical question about healthcare use within the iMCQ, participants are first asked to recall whether they consulted an healthcare professional over a pre-specified past period (Question 1a). Depending on their choice, the questionnaire re-directs the respondent to either specify the number of appointments taken (Question 1b) or to simply go to the following question about a different type of resource use. This specific formulation of the questions allows to discern the participants who used a given type of service from those who did not and, for the former, to retrieve numerical evidence about the amount of the service used within a given time period. The same approach is typically replicated for most types of healthcare services to include evidence of their use (and related costs) in the economic evaluation.</p>
<div id="fig-imcq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imcq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="imcq_1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imcq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Example of some of the healthcare use questions in the iMCQ questionnaire. Source: https://www.imta.nl/questionnaires/imcq/
</figcaption>
</figure>
</div>
<p>Alongside trials, <span class="citation" data-cites="ridyard2010methods">Ridyard and Hughes (<a href="#ref-ridyard2010methods" role="doc-biblioref">2010</a>)</span> identified five main data collection methods for HRU data: 1) Medical records (e.g.&nbsp;patient notes, large databases); 2) Prospective forms completed by trial researchers or healthcare professionals, either based on patient recall or not; 3) Patient-completed or carer-/non-healthcare professional completed instruments, either in the form of diaries or forms/questionnaires. While medical records tend to be more complete with the potential to provide a longer time period of retrospective data for the patient, they require more resources and may have patient consent and confidentiality issues associated with accessing the information. Alternatively, self-reported questionnaires may represent a cheaper and relatively simple way to collect HRU information from the population of interest, but they may result more burdensome for patients to complete and potentially lead to a considerable loss of information <span class="citation" data-cites="clarke2008optimal">(<a href="#ref-clarke2008optimal" role="doc-biblioref">Clarke, Fiebig, and Gerdtham 2008</a>)</span>.</p>
<p>A key advantage of using standardised instruments for collecting resource use data, such as CSRI or iMCQ, is to facilitate cross-study comparisons. However, there may be specific aspects of resource use and costs that are important to capture in certain, but not all, decision problems. As such, standardised resource-use measurement instruments may not be specific enough to capture all important resources for particular decision problems <span class="citation" data-cites="byford2007comparison">(<a href="#ref-byford2007comparison" role="doc-biblioref">Byford et al. 2007</a>)</span>. Researchers tend to tailor instruments to focus on specific information needed for analysis, which is particularly important when taking a broader perspective, such as information related to informal care and other wider aspects that are not routinely collected within medical records or in large databases. Medical records offer an alternative approach to HRU data collection that can include anything from raw data extracted straight from a service, to the level of linked datasets across multiple services. However, an issue with electronic datasets is that they may only adequately record data for a particular service, pose concerns related to data quality that require assessment and validation, and question the exchangeability of using person-reported or medical records data as they may produce quite different estimates <span class="citation" data-cites="noben2016exchangeability">(<a href="#ref-noben2016exchangeability" role="doc-biblioref">Noben et al. 2016</a>)</span>.</p>
<p>We will exclusively focus on the description and analysis of HRU and cost data generated based on participants’ responses to some form of standardised instrument, which has traditionally represented the standard approach for HRU data collection in trial-based economic evaluations <span class="citation" data-cites="franklin2019self">(<a href="#ref-franklin2019self" role="doc-biblioref"><strong>franklin2019self?</strong></a>)</span>. However, we note that, no specific data collection method can currently be considered the “gold standard” for the purpose of informing trial-based analyses. In most cases, it is the researcher who decides on which method depending on the circumstances (e.g.&nbsp;trial design, setting, etc.) and the data of interest for the trial.</p>
<p><a href="#fig-histGP" class="quarto-xref">Figure&nbsp;2</a> shows the observed GP HRU data by treatment arm collected via iMCQ over a period of 12 weeks from a two-arm RCT of continence care for people with intellectual disabilities in the Netherlands <span class="citation" data-cites="van2022smart">(<a href="#ref-van2022smart" role="doc-biblioref">Van Cooten et al. 2022</a>)</span>. Similarly to what shown in the graphs, most type of HRU data tend to share similar features from a statistical perspective: can vary widely between participants, are bounded below by 0 (i.e.&nbsp;no use), tend to be positively skewed, and are often affected by some missing values. In particular, the presence of positive skewness in HRU data is typically due to the fact that a small number of individuals consume large HRU values while the rest tends to use relatively small or no quantities of the healthcare service.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-histGP" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="h">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histGP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-histGP-1.png" class="img-fluid figure-img" style="width:70.0%" data-fig-pos="h">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histGP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Histogram of the observed distribution of GP HRU data by treatment arm (Control and Intervention) in the continence care study.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-table1" class="quarto-xref">Table&nbsp;1</a> reports summary statistics for the HRU GP data by treatment arm in the continence care trial. In both arms, GP observed resource use are characterised by small average and median values with relatively large variation measures and non-negligible missing percentages. In addition, among the observed values, about 48% and 68% are those associated with no use of service (i.e.&nbsp;zero) in the control and intervention arm, respectively.</p>
<div class="cell">
<div id="tbl-table1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Summary statistics in terms of mean (standard deviation), median (interquartile range), and number (proportion) of missing values for GP HRU data in the continence care study by treatment arm.
</figcaption>
<div aria-describedby="tbl-table1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ztpgfpfdrr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ztpgfpfdrr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ztpgfpfdrr thead, #ztpgfpfdrr tbody, #ztpgfpfdrr tfoot, #ztpgfpfdrr tr, #ztpgfpfdrr td, #ztpgfpfdrr th {
  border-style: none;
}

#ztpgfpfdrr p {
  margin: 0;
  padding: 0;
}

#ztpgfpfdrr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ztpgfpfdrr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ztpgfpfdrr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ztpgfpfdrr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ztpgfpfdrr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztpgfpfdrr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztpgfpfdrr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztpgfpfdrr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ztpgfpfdrr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ztpgfpfdrr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ztpgfpfdrr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ztpgfpfdrr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ztpgfpfdrr .gt_spanner_row {
  border-bottom-style: hidden;
}

#ztpgfpfdrr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ztpgfpfdrr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ztpgfpfdrr .gt_from_md > :first-child {
  margin-top: 0;
}

#ztpgfpfdrr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ztpgfpfdrr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ztpgfpfdrr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ztpgfpfdrr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ztpgfpfdrr .gt_row_group_first td {
  border-top-width: 2px;
}

#ztpgfpfdrr .gt_row_group_first th {
  border-top-width: 2px;
}

#ztpgfpfdrr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztpgfpfdrr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ztpgfpfdrr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ztpgfpfdrr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztpgfpfdrr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztpgfpfdrr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ztpgfpfdrr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ztpgfpfdrr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ztpgfpfdrr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztpgfpfdrr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztpgfpfdrr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztpgfpfdrr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztpgfpfdrr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztpgfpfdrr .gt_left {
  text-align: left;
}

#ztpgfpfdrr .gt_center {
  text-align: center;
}

#ztpgfpfdrr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ztpgfpfdrr .gt_font_normal {
  font-weight: normal;
}

#ztpgfpfdrr .gt_font_bold {
  font-weight: bold;
}

#ztpgfpfdrr .gt_font_italic {
  font-style: italic;
}

#ztpgfpfdrr .gt_super {
  font-size: 65%;
}

#ztpgfpfdrr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ztpgfpfdrr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ztpgfpfdrr .gt_indent_1 {
  text-indent: 5px;
}

#ztpgfpfdrr .gt_indent_2 {
  text-indent: 10px;
}

#ztpgfpfdrr .gt_indent_3 {
  text-indent: 15px;
}

#ztpgfpfdrr .gt_indent_4 {
  text-indent: 20px;
}

#ztpgfpfdrr .gt_indent_5 {
  text-indent: 25px;
}

#ztpgfpfdrr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ztpgfpfdrr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Control</strong><br>
N = 74</th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Intervention</strong><br>
N = 82</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">HRUgp</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="stat_1">1.59 (2.43)</td>
<td class="gt_row gt_center" headers="stat_2">0.77 (1.69)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="stat_1">1.00 (2.00)</td>
<td class="gt_row gt_center" headers="stat_2">0.00 (1.00)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Missing</td>
<td class="gt_row gt_center" headers="stat_1">16 (22%)</td>
<td class="gt_row gt_center" headers="stat_2">17 (21%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>These characteristics are common to most types of individual-level HRU data collected alongside trials via self-reported instruments and may pose considerable challenges for the statistical analysis in the economic evaluation.</p>
<p>Sorry for the short post but I hope it was still interesting to have a look at this topic which, I must say, if often neglected in the context of data analysis, where focus is simply given to cost data. However, I believe that taking into consideration the “true” source of costs, i.e.&nbsp;type and number of healthcare services used, may represent a key aspect when performing economic evaluations. For example, the ability to distinguish the different components that form the total costs for an individual may be important in order to understand what are the main drivers of the costs as well as to identify specific groups of resource use data that are characterised by unexpected and/or challenging features (e.g.&nbsp;excess of zeros due to lack of use of service).</p>
<p>In addition, what happens when data are only partially-collected for some resource use types but not for others? can we think about possible reasons for why individuals did not use a given service or perhaps this type of missingness was mostly likely due to a lost record? I will come back to this point in the future but, for the moment, let’s just say that the type and level of data aggregation at which you address missingness may be quite important and influence the results of an analysis. However, in practice, there seems to be a general lack of clarity about how missing resource use data are addressed in the literature <span class="citation" data-cites="ling2022scoping">Ling et al. (<a href="#ref-ling2022scoping" role="doc-biblioref">2022</a>)</span>, which makes the reliability of the (implicit) assumptions formulated in the analysis stage much more difficult to justify!</p>
<p>More about this topic in the future, also from a more quantitative research-oriented perspective, stay tuned!</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-beecham2001costing" class="csl-entry" role="listitem">
Beecham, J, and M Knapp. 2001. <span>“Costing Psychiatric Interventions. Thornicroft g, Ed.”</span> <em>Measuring Mental Health Needs. London: Gaskell</em> 201: 24.
</div>
<div id="ref-bouwmans2015imta" class="csl-entry" role="listitem">
Bouwmans, Clazien, Marieke Krol, Hans Severens, Marc Koopmanschap, Werner Brouwer, and Leona Hakkaart-van Roijen. 2015. <span>“The iMTA Productivity Cost Questionnaire: A Standardized Instrument for Measuring and Valuing Health-Related Productivity Losses.”</span> <em>Value in Health</em> 18 (6): 753–58.
</div>
<div id="ref-byford2007comparison" class="csl-entry" role="listitem">
Byford, Sarah, Morven Leese, Martin Knapp, Helen Seivewright, Susan Cameron, Vanessa Jones, Kate Davidson, and Peter Tyrer. 2007. <span>“Comparison of Alternative Methods of Collection of Service Use Data for the Economic Evaluation of Health Care Interventions.”</span> <em>Health Economics</em> 16 (5): 531–36.
</div>
<div id="ref-clarke2008optimal" class="csl-entry" role="listitem">
Clarke, Philip M, Denzil G Fiebig, and Ulf-G Gerdtham. 2008. <span>“Optimal Recall Length in Survey Design.”</span> <em>Journal of Health Economics</em> 27 (5): 1275–84.
</div>
<div id="ref-drummond2015methods" class="csl-entry" role="listitem">
Drummond, Michael F, Mark J Sculpher, Karl Claxton, Greg L Stoddart, and George W Torrance. 2015. <em>Methods for the Economic Evaluation of Health Care Programmes</em>. Oxford university press.
</div>
<div id="ref-gold1996cost" class="csl-entry" role="listitem">
Gold, MR. 1996. <em>Cost-Effectiveness in Health and Medicine</em>. Vol. 20. Oxford University Press.
</div>
<div id="ref-gray2010applied" class="csl-entry" role="listitem">
Gray, Alastair M, Philip M Clarke, Jane L Wolstenholme, and Sarah Wordsworth. 2010. <em>Applied Methods of Cost-Effectiveness Analysis in Healthcare</em>. Vol. 3. OUP Oxford.
</div>
<div id="ref-ling2022scoping" class="csl-entry" role="listitem">
Ling, Xiaoxiao, Andrea Gabrio, Alexina Mason, and Gianluca Baio. 2022. <span>“A Scoping Review of Item-Level Missing Data in Within-Trial Cost-Effectiveness Analysis.”</span> <em>Value in Health</em> 25 (9): 1654–62.
</div>
<div id="ref-noben2016exchangeability" class="csl-entry" role="listitem">
Noben, Cindy Yvonne, Angelique de Rijk, Frans Nijhuis, Jan Kottner, and Silvia Evers. 2016. <span>“The Exchangeability of Self-Reports and Administrative Health Care Resource Use Measurements: Assessement of the Methodological Reporting Quality.”</span> <em>Journal of Clinical Epidemiology</em> 74: 93–106.
</div>
<div id="ref-ridyard2010methods" class="csl-entry" role="listitem">
Ridyard, Colin H, and Dyfrig A Hughes. 2010. <span>“Methods for the Collection of Resource Use Data Within Clinical Trials: A Systematic Review of Studies Funded by the UK Health Technology Assessment Program.”</span> <em>Value in Health</em> 13 (8): 867–72.
</div>
<div id="ref-rotterdam2018imta" class="csl-entry" role="listitem">
Rotterdam, EU. 2018. <span>“iMTA Productivity and Health Research GroupManual iMTA Medical Cost Questionnaire (iMCQ).”</span> <em>Rotterdam: iMTA</em>.
</div>
<div id="ref-van2022smart" class="csl-entry" role="listitem">
Van Cooten, Vivette JC, Marieke FM Gielissen, Ghislaine APG Van Mastrigt, Wouter Den Hollander, Silvia MAA Evers, Odile Smeets, Filip Smit, and Brigitte Boon. 2022. <span>“Smart Continence Care for People with Profound Intellectual and Multiple Disabilities: Protocol for a Cluster Randomized Trial and Trial-Based Economic Evaluation.”</span> <em>JMIR Research Protocols</em> 11 (11): e42555.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Andrea Gabrio</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>